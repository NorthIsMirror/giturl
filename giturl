#!/usr/bin/env zsh

local ZERO="${(%):-%N}"
local BIN_DIR="${ZERO:h}"

# On asciinema 0 and ZERO are functionargzero
[[ "$BIN_DIR" = "." ]] && BIN_DIR="/usr/local/bin"

local SHARE_DIR="${BIN_DIR:h}/share"
source "$SHARE_DIR/giturl/script_preamble"
source "$SHARE_DIR/giturl/script_vars"
source "$SHARE_DIR/giturl/math_functions"
source "$SHARE_DIR/giturl/codes_huffman"
source "$SHARE_DIR/giturl/coding_functions"

GU_HELP="0"
GU_VERBOSE="-s"
GU_QUIET="0"
GU_NOANSI="0"
GU_REPO=""
local -A opthash
zparseopts -E -D -A opthash h -help v -verbose q -quiet n -noansi r: -repo: || { echo "Improper options given, see help -h"; exit 1; }

(( ${+opthash[-h]} + ${+opthash[--help]} ))     && GU_HELP="1"
(( ${+opthash[-v]} + ${+opthash[--verbose]} ))  && GU_VERBOSE=""
(( ${+opthash[-q]} + ${+opthash[--quiet]} ))    && GU_QUIET="1"
(( ${+opthash[-n]} + ${+opthash[--noansi]} ))   && GU_NOANSI="1"
(( ${+opthash[-r]} ))                           && GU_REPO="${opthash[-r]}"
(( ${+opthash[--repo]} ))                       && GU_REPO="${opthash[--repo]}"

exit 0
